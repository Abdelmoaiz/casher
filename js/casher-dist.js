let tmp,mydataPro,titlePro=document.querySelector("#title"),quantityPro=document.querySelector("#quantity"),packetPrice=document.querySelector("#packetPrice"),onePrice=document.querySelector("#onePrice"),myDate=new Date;mydataPro=null!=localStorage.myData?JSON.parse(localStorage.myData):[];let product,namePro,packetPro,quaPro,divInputPro,btnPack,btnOne,num,Count,invoice,sales,allProducts=document.querySelector("#allProducts");function readProduct(){if(""!=mydataPro)for(let t=0;t<mydataPro.length;t++)product=document.createElement("div"),product.className="product",namePro=document.createElement("h3"),quaPro=document.createElement("span"),divInputPro=document.createElement("div"),divInputPro.className="divInputPro",btnPack=document.createElement("button"),btnPack.innerHTML="Packet",btnPack.setAttribute("onclick",`salePacket(${t});`),btnPack.className="btnPack",btnOne=document.createElement("button"),btnOne.innerHTML="One",btnOne.className="btnOne",btnOne.setAttribute("onclick",`saleOne(${t});`),divInputPro.append(btnOne,btnPack),namePro.innerHTML=`${mydataPro[t].title}`,quaPro.innerHTML=""+ +mydataPro[t].totalQu,product.append(namePro,quaPro,divInputPro),allProducts.append(product)}function saleOne(t){mydataPro[t].totalQu>0&&(titlePro.value=mydataPro[t].title,price.value=mydataPro[t].price,quantityPro.value=1,Count=1,quantityPro.focus(),tmp=t)}function salePacket(t){mydataPro[t].totalQu>=24&&(titlePro.value=mydataPro[t].title,price.value=mydataPro[t].priceSale,quantityPro.value=1,Count=+mydataPro[t].quantity,quantityPro.focus(),tmp=t)}readProduct(),invoice=null!=localStorage.myInvoice?JSON.parse(localStorage.myInvoice):[],sales=null!=localStorage.mySales?JSON.parse(localStorage.mySales):[];let table,allInvoices=[];function insertItems(){let t="";""!=titlePro.value&&""!=price.value&&(t={invoiceNum:`${invoice.length}`,date:`${myDate.getFullYear()}/${myDate.getMonth()+1}/${myDate.getDate()}`,time:`${myDate.getHours()}:${myDate.getMinutes()}:${myDate.getSeconds()}`,titlePro:titlePro.value,price:+price.value,quantityPro:+quantityPro.value*Count,amount:+quantityPro.value*+price.value},mydataPro[tmp].totalQu-=+t.quantityPro,mydataPro[tmp].count=+mydataPro[tmp].totalQu/+mydataPro[tmp].quantity,allInvoices.push(t),sales.push(t),addInvoiceItems(),totalInvoice(),clearInput())}function save(){invoice.push(allInvoices),localStorage.setItem("myInvoice",JSON.stringify(invoice)),localStorage.setItem("mySales",JSON.stringify(sales)),localStorage.setItem("myData",JSON.stringify(mydataPro)),refresh()}function addInvoiceItems(){table="";for(let t=0;t<allInvoices.length;t++)table+=`\n        <tr>\n            <td>${t+1}</td>\n            <td>${allInvoices[t].titlePro}</td>\n            <td>${allInvoices[t].quantityPro}</td>\n            <td>${allInvoices[t].price}</td>\n            <td>${allInvoices[t].amount}</td>\n           \n            \n        </tr>\n    `;document.querySelector(".tbody").innerHTML=table}function totalInvoice(){let t=0;for(let e=0;e<allInvoices.length;e++)t+=allInvoices[e].amount;table+=`\n         <tr>\n             <td colspan='4' class='invoiceTotal'>Total</td>\n             <td>${t}</td>\n         </tr>\n     `,document.querySelector(".tbody").innerHTML=table}addInvoiceItems(),totalInvoice();let search=document.querySelector("#search");function searchPro(t){allProducts.innerHTML="";for(let e=0;e<mydataPro.length;e++)mydataPro[e].title.includes(t)&&(product=document.createElement("div"),product.className="product",namePro=document.createElement("h3"),quaPro=document.createElement("span"),divInputPro=document.createElement("div"),divInputPro.className="divInputPro",btnPack=document.createElement("button"),btnPack.innerHTML="Packet",btnPack.setAttribute("onclick",`salePacket(${e});`),btnPack.className="btnPack",btnOne=document.createElement("button"),btnOne.innerHTML="One",btnOne.className="btnOne",btnOne.setAttribute("onclick",`saleOne(${e});`),divInputPro.append(btnOne,btnPack),namePro.innerHTML=`${mydataPro[e].title}`,quaPro.innerHTML=""+ +mydataPro[e].totalQu,product.append(namePro,quaPro,divInputPro),allProducts.append(product))}function excretionsPro(t){mydataPro[t].totalQu-=+quantityPro.value,mydataPro[t].count=+mydataPro[t].totalQu/+mydataPro[t].quantity,console.log(+mydataPro[t].count)}function clearInput(){titlePro.value=price.value=quantityPro.value=""}function refresh(){window.location.reload()}